{"ast":null,"code":"// src/components/AudiencePage.js\nimport React,{useState}from\"react\";import axios from\"axios\";import DatePicker from\"react-datepicker\";import\"react-datepicker/dist/react-datepicker.css\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Audience=()=>{const[rules,setRules]=useState([]);const[field,setField]=useState(\"\");const[operator,setOperator]=useState(\"\");const[value,setValue]=useState(\"\");const[audienceSize,setAudienceSize]=useState(0);const fieldOptions=[{label:\"Total Spend\",value:\"total_spend\"},{label:\"Visits\",value:\"visits\"},{label:\"Last Visit\",value:\"last_visit\"}];const operatorOptions={total_spend:[\">\",\">=\",\"<\",\"<=\",\"==\"],visits:[\">\",\">=\",\"<\",\"<=\",\"==\"],last_visit:[\"==\",\">\",\"<\"]};const addRule=()=>{if(field&&operator&&value){const newRule={field,operator,value};setRules([...rules,newRule]);setField(\"\");setOperator(\"\");setValue(\"\");}else{alert(\"Please enter a valid rule.\");}};const removeRule=index=>{setRules(rules.filter((_,i)=>i!==index));};const checkAudienceSize=async()=>{try{const response=await axios.post(\"https://projectcrm-dgrs.onrender.com/api/check-audience\",{rules});setAudienceSize(response.data.audienceSize);}catch(error){console.error(\"Error checking audience size:\",error);}};const saveAudience=async()=>{try{await axios.post(\"https://projectcrm-dgrs.onrender.com/api/save-audience\",{rules});window.location.href=\"/dashboard\";}catch(error){console.error(\"Error saving audience:\",error);}};const renderValueInput=()=>{if(field===\"last_visit\"){return/*#__PURE__*/_jsx(DatePicker,{selected:value?new Date(value):null,onChange:date=>setValue(date.toISOString().split(\"T\")[0]),className:\"form-control\",dateFormat:\"yyyy-MM-dd\"});}else{return/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"Value\",value:value,onChange:e=>setValue(e.target.value)});}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"nav\",{className:\"navbar navbar-dark bg-dark\",children:/*#__PURE__*/_jsx(\"a\",{className:\"navbar-brand\",href:\"/dashboard\",children:\"CustomerReach\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"container mt-5\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create Audience\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group mb-3\",children:[/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",value:field,onChange:e=>{setField(e.target.value);setOperator(\"\");setValue(\"\");},children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Field\"}),fieldOptions.map(option=>/*#__PURE__*/_jsx(\"option\",{value:option.value,children:option.label},option.value))]}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",value:operator,onChange:e=>setOperator(e.target.value),children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Select Operator\"}),field&&operatorOptions[field].map(op=>/*#__PURE__*/_jsx(\"option\",{value:op,children:op},op))]}),renderValueInput(),/*#__PURE__*/_jsx(\"div\",{className:\"input-group-append\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-secondary\",onClick:addRule,children:\"Add Rule\"})})]}),/*#__PURE__*/_jsx(\"ul\",{className:\"list-group mb-3\",children:rules.map((rule,index)=>/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item d-flex justify-content-between align-items-center\",children:[\"\".concat(rule.field,\" \").concat(rule.operator,\" \").concat(rule.value),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-danger btn-sm\",onClick:()=>removeRule(index),children:\"Remove\"})]},index))}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary mb-3\",onClick:checkAudienceSize,children:\"Check Audience Size\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Audience Size: \",audienceSize]}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:saveAudience,children:\"Save Audience\"})]})]});};export default Audience;","map":{"version":3,"names":["React","useState","axios","DatePicker","jsx","_jsx","jsxs","_jsxs","Audience","rules","setRules","field","setField","operator","setOperator","value","setValue","audienceSize","setAudienceSize","fieldOptions","label","operatorOptions","total_spend","visits","last_visit","addRule","newRule","alert","removeRule","index","filter","_","i","checkAudienceSize","response","post","data","error","console","saveAudience","window","location","href","renderValueInput","selected","Date","onChange","date","toISOString","split","className","dateFormat","type","placeholder","e","target","children","map","option","op","onClick","rule","concat"],"sources":["E:/project/GGSIPU/xeno/frontend/src/components/AudiencePage.jsx"],"sourcesContent":["// src/components/AudiencePage.js\r\nimport React, { useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport DatePicker from \"react-datepicker\";\r\nimport \"react-datepicker/dist/react-datepicker.css\";\r\n\r\nconst Audience = () => {\r\n  const [rules, setRules] = useState([]);\r\n  const [field, setField] = useState(\"\");\r\n  const [operator, setOperator] = useState(\"\");\r\n  const [value, setValue] = useState(\"\");\r\n  const [audienceSize, setAudienceSize] = useState(0);\r\n\r\n  const fieldOptions = [\r\n    { label: \"Total Spend\", value: \"total_spend\" },\r\n    { label: \"Visits\", value: \"visits\" },\r\n    { label: \"Last Visit\", value: \"last_visit\" },\r\n  ];\r\n\r\n  const operatorOptions = {\r\n    total_spend: [\">\", \">=\", \"<\", \"<=\", \"==\"],\r\n    visits: [\">\", \">=\", \"<\", \"<=\", \"==\"],\r\n    last_visit: [\"==\", \">\", \"<\"],\r\n  };\r\n\r\n  const addRule = () => {\r\n    if (field && operator && value) {\r\n      const newRule = { field, operator, value };\r\n      setRules([...rules, newRule]);\r\n      setField(\"\");\r\n      setOperator(\"\");\r\n      setValue(\"\");\r\n    } else {\r\n      alert(\"Please enter a valid rule.\");\r\n    }\r\n  };\r\n\r\n  const removeRule = (index) => {\r\n    setRules(rules.filter((_, i) => i !== index));\r\n  };\r\n\r\n  const checkAudienceSize = async () => {\r\n    try {\r\n      const response = await axios.post(\r\n        \"https://projectcrm-dgrs.onrender.com/api/check-audience\",\r\n        { rules }\r\n      );\r\n      setAudienceSize(response.data.audienceSize);\r\n    } catch (error) {\r\n      console.error(\"Error checking audience size:\", error);\r\n    }\r\n  };\r\n\r\n  const saveAudience = async () => {\r\n    try {\r\n      await axios.post(\"https://projectcrm-dgrs.onrender.com/api/save-audience\", { rules });\r\n      window.location.href = \"/dashboard\";\r\n    } catch (error) {\r\n      console.error(\"Error saving audience:\", error);\r\n    }\r\n  };\r\n\r\n  const renderValueInput = () => {\r\n    if (field === \"last_visit\") {\r\n      return (\r\n        <DatePicker\r\n          selected={value ? new Date(value) : null}\r\n          onChange={(date) => setValue(date.toISOString().split(\"T\")[0])}\r\n          className=\"form-control\"\r\n          dateFormat=\"yyyy-MM-dd\"\r\n        />\r\n      );\r\n    } else {\r\n      return (\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control\"\r\n          placeholder=\"Value\"\r\n          value={value}\r\n          onChange={(e) => setValue(e.target.value)}\r\n        />\r\n      );\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <nav className=\"navbar navbar-dark bg-dark\">\r\n        <a className=\"navbar-brand\" href=\"/dashboard\">\r\n          CustomerReach\r\n        </a>\r\n      </nav>\r\n      <div className=\"container mt-5\">\r\n        <h2>Create Audience</h2>\r\n        <div className=\"input-group mb-3\">\r\n          <select\r\n            className=\"form-control\"\r\n            value={field}\r\n            onChange={(e) => {\r\n              setField(e.target.value);\r\n              setOperator(\"\");\r\n              setValue(\"\");\r\n            }}\r\n          >\r\n            <option value=\"\">Select Field</option>\r\n            {fieldOptions.map((option) => (\r\n              <option key={option.value} value={option.value}>\r\n                {option.label}\r\n              </option>\r\n            ))}\r\n          </select>\r\n          <select\r\n            className=\"form-control\"\r\n            value={operator}\r\n            onChange={(e) => setOperator(e.target.value)}\r\n          >\r\n            <option value=\"\">Select Operator</option>\r\n            {field &&\r\n              operatorOptions[field].map((op) => (\r\n                <option key={op} value={op}>\r\n                  {op}\r\n                </option>\r\n              ))}\r\n          </select>\r\n          {renderValueInput()}\r\n          <div className=\"input-group-append\">\r\n            <button className=\"btn btn-outline-secondary\" onClick={addRule}>\r\n              Add Rule\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <ul className=\"list-group mb-3\">\r\n          {rules.map((rule, index) => (\r\n            <li\r\n              key={index}\r\n              className=\"list-group-item d-flex justify-content-between align-items-center\"\r\n            >\r\n              {`${rule.field} ${rule.operator} ${rule.value}`}\r\n              <button\r\n                className=\"btn btn-danger btn-sm\"\r\n                onClick={() => removeRule(index)}\r\n              >\r\n                Remove\r\n              </button>\r\n            </li>\r\n          ))}\r\n        </ul>\r\n        <button className=\"btn btn-primary mb-3\" onClick={checkAudienceSize}>\r\n          Check Audience Size\r\n        </button>\r\n        <p>Audience Size: {audienceSize}</p>\r\n        <button className=\"btn btn-success\" onClick={saveAudience}>\r\n          Save Audience\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Audience;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}